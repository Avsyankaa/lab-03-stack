os: linux

language: cpp
sudo: false

addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    packages:
    - libstdc++-7-dev
    - g++-7
    update: true

env: CC_EVAL=gcc-7 CXX_EVAL=g++-7

before_install:
  - export CXX=${CXX_EVAL}
  - export CC=${CC_EVAL}

script:
  - chmod 777 ./cpplint.py
  - ( for file in $(find ./ -name "*.cpp"); do ./cpplint.py $file || exit; done );
  - cmake -H. -B_builds -DCMAKE_EXPORT_COMPILE_COMMANDS=YES
  - cmake --build _builds
  - ( for file in $(find ../ -name "*.cpp"); do echo $file; clang-check -analyze $file -p ./ || exit; done );
  - ./_builds/executable

notifications:
  email: false
